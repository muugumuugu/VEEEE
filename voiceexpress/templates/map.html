<!-- Page template: map.html. VoiceExpress page contract with layout, metadata, and interaction hooks. -->
{% extends "base.html" %}
{% block content %}
<section class="map-page">
  <h1>VoiceExpress Map</h1>
  <p>Geotagged artifacts plotted by route and month.</p>
  <div id="map" class="map"></div>
</section>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const map = L.map("map").setView([39.5, -98.35], 4);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "Â© OpenStreetMap contributors"
    }).addTo(map);
    const artifacts = {{ artifacts | tojson }};
    artifacts.forEach((artifact) => {
      const [lat, lng] = artifact.geotag.split(",").map(Number);
      L.marker([lat, lng]).addTo(map)
        .bindPopup(`<strong>${artifact.title}</strong><br/>${artifact.location}`);
    });
  });
</script>
{% endblock %}
